<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ë³„ìë¦¬ ì „ìŸ: ì¤‘ì•™ ì „íˆ¬íŒ</title>
<style>
body { margin:0; font-family: 'Arial', sans-serif; background:#0b0b2b; color:#fff; text-align:center; overflow-x:hidden; }
h1 { margin-top:20px; color:#f9d71c; text-shadow:0 0 5px #fff; }
#scoreBoard { margin:20px; font-size:20px; }
#handArea { display:flex; justify-content:center; margin:20px; }
.card { width:120px; height:180px; margin:5px; background:#1a1a3b; border-radius:15px; border:2px solid #fff; padding:10px; box-shadow:0 0 10px #fff; transition: transform 0.3s; position:relative; }
.card:hover { transform: translateY(-10px) scale(1.05); cursor:pointer; box-shadow:0 0 20px #f9d71c; }
.card h3 { margin:10px 0 5px 0; font-size:16px; }
#battleArea { position:relative; height:300px; margin:20px; }
.battleCard { width:150px; height:220px; position:absolute; top:20px; transition: all 0.5s; border-radius:15px; border:2px solid #fff; padding:10px; background:#1a1a3b; box-shadow:0 0 15px #fff; }
#playerBattle { left:calc(50% - 180px); }
#compBattle { left:calc(50% + 30px); }
#diceArea { position:absolute; top:100px; left:50%; transform:translateX(-50%); display:flex; justify-content:center; align-items:center; }
.dice { font-size:50px; display:inline-block; width:60px; height:60px; line-height:60px; border-radius:10px; background:#fff; color:#000; margin:5px; font-weight:bold; }
#log { position:absolute; bottom:0; left:50%; transform:translateX(-50%); width:90%; max-width:600px; background:#111133; padding:10px; border-radius:10px 10px 0 0; height:180px; overflow-y:auto; text-align:left; font-size:14px; }
.flash { animation: flash 0.6s; }
@keyframes flash {0%{background-color:#1a1a3b;}50%{background-color:#ff0000;}100%{background-color:#1a1a3b;}}
.goldFlash { animation: goldFlash 0.8s; }
@keyframes goldFlash {0%{background-color:#1a1a3b;}50%{background-color:#f9d71c;}100%{background-color:#1a1a3b;}}
</style>
</head>
<body>
<h1>ë³„ìë¦¬ ì „ìŸ: ì¤‘ì•™ ì „íˆ¬íŒ</h1>
<div id="scoreBoard">ì ìˆ˜: <span id="playerScore">0</span> : <span id="computerScore">0</span></div>

<div id="handArea"></div>

<div id="battleArea">
  <div id="playerBattle" class="battleCard"></div>
  <div id="compBattle" class="battleCard"></div>
  <div id="diceArea">
    <div id="playerDice" class="dice">ğŸ²</div>
    <div id="compDice" class="dice">ğŸ²</div>
  </div>
</div>

<div id="log"></div>

<script>
const allCards=[
{name:'ì–‘ìë¦¬', ability:'+1 ê³µê²©'},
{name:'í™©ì†Œìë¦¬', ability:'ì²« íŒ¨ë°° ë¬´íš¨'},
{name:'ìŒë‘¥ì´ìë¦¬', ability:'ì£¼ì‚¬ìœ„ ë‘ ë²ˆ êµ´ë ¤ ë†’ì€ ìˆ˜ ì„ íƒ'},
{name:'ê²Œìë¦¬', ability:'íŒ¨ë°°í•´ë„ 1ë²ˆ ë” ì‚¬ìš©'},
{name:'ì‚¬ììë¦¬', ability:'ìŠ¹ë¦¬ ì‹œ ë‹¤ìŒ í„´ +1'},
{name:'ì²˜ë…€ìë¦¬', ability:'ìƒëŒ€ ì£¼ì‚¬ìœ„ 1íšŒ ë¬´íš¨í™”'},
{name:'ì²œì¹­ìë¦¬', ability:'ë¬´ìŠ¹ë¶€ ì‹œ ìŠ¹ë¦¬'},
{name:'ì „ê°ˆìë¦¬', ability:'íŒ¨ë°° ì‹œ ìƒëŒ€ ë‹¤ìŒ í„´ -1'},
{name:'ì‚¬ìˆ˜ìë¦¬', ability:'ì£¼ì‚¬ìœ„ 1íšŒ ì¬êµ´ë¦¼ ê°€ëŠ¥'},
{name:'ì—¼ì†Œìë¦¬', ability:'2ì—°íŒ¨ í›„ +2'},
{name:'ë¬¼ë³‘ìë¦¬', ability:'ì¹´ë“œ êµì²´ ê°€ëŠ¥'},
{name:'ë¬¼ê³ ê¸°ìë¦¬', ability:'ìƒëŒ€ ì˜ˆì¸¡ ì„±ê³µ ì‹œ ìŠ¹ë¦¬'}
];

let playerHand=[], computerHand=[];
let playerScore=0, computerScore=0;
let round=1;
let playerNextBonus=0, computerNextBonus=0;

function shuffle(array){return array.sort(()=>Math.random()-0.5);}
function deal(){
  const shuffled=shuffle([...allCards]);
  playerHand=shuffled.slice(0,3);
  computerHand=shuffled.slice(3,6);
  logMsg('ê²Œì„ ì‹œì‘! ì¹´ë“œ ì„ íƒí•˜ì„¸ìš”.');
  updateHand();
  clearBattle();
}

function updateHand(){
  const container=document.getElementById('handArea');
  container.innerHTML='';
  playerHand.forEach((card,idx)=>{
    const div=document.createElement('div');
    div.className='card';
    div.innerHTML=`<h3>${card.name}</h3><p>${card.ability}</p><button onclick="playCard(${idx})">ì„ íƒ</button>`;
    container.appendChild(div);
  });
}

function clearBattle(){
  document.getElementById('playerBattle').innerHTML='';
  document.getElementById('compBattle').innerHTML='';
  document.getElementById('playerDice').textContent='ğŸ²';
  document.getElementById('compDice').textContent='ğŸ²';
}

function rollDiceVisual(id, callback){
  const diceEl=document.getElementById(id);
  let count=0;
  const interval=setInterval(()=>{
    const roll=Math.floor(Math.random()*6)+1;
    diceEl.textContent=roll;
    count++;
    if(count>=10){ clearInterval(interval); callback(roll);}
  },50);
}

function playCard(idx){
  const playerCard=playerHand[idx];
  const compIdx=Math.floor(Math.random()*computerHand.length);
  const compCard=computerHand[compIdx];

  // ì¤‘ì•™ ì¹´ë“œ ë°°ì¹˜
  document.getElementById('playerBattle').innerHTML=`<h3>${playerCard.name}</h3><p>${playerCard.ability}</p>`;
  document.getElementById('compBattle').innerHTML=`<h3>${compCard.name}</h3>`;
  logMsg(`ë¼ìš´ë“œ ${round}: ë„ˆ - ${playerCard.name} vs ì»´í“¨í„° - ${compCard.name}`);

  // 2ì´ˆ ëŒ€ê¸° í›„ ì£¼ì‚¬ìœ„ êµ´ë¦¼ ë° ìŠ¹íŒ¨ ì²˜ë¦¬
  setTimeout(()=>{
    rollDiceVisual('playerDice', (playerRoll)=>{
      rollDiceVisual('compDice', (compRoll)=>{

        // ëŠ¥ë ¥ ì ìš©
        if(playerCard.name==='ìŒë‘¥ì´ìë¦¬'){ const r=Math.floor(Math.random()*6)+1; playerRoll=Math.max(playerRoll,r);}
        if(playerCard.name==='ì‚¬ìˆ˜ìë¦¬'){ const r=Math.floor(Math.random()*6)+1; playerRoll=Math.max(playerRoll,r);}
        if(playerCard.name==='ì–‘ìë¦¬') playerRoll+=1;
        playerRoll+=playerNextBonus; playerNextBonus=0;

        if(compCard.name==='ì–‘ìë¦¬') compRoll+=1;
        compRoll+=computerNextBonus; computerNextBonus=0;

        let winner='';
        // ë¬¼ê³ ê¸°ìë¦¬ 50% ì˜ˆì¸¡ ì„±ê³µ
        if(playerCard.name==='ë¬¼ê³ ê¸°ìë¦¬' && Math.random()<0.5){ winner='player'; logMsg('ë¬¼ê³ ê¸°ìë¦¬ ì˜ˆì¸¡ ì„±ê³µ! ì¦‰ì‹œ ìŠ¹ë¦¬!'); flashCard('playerBattle','goldFlash'); }
        else if(compCard.name==='ë¬¼ê³ ê¸°ìë¦¬' && Math.random()<0.5){ winner='computer'; logMsg('ì»´í“¨í„° ë¬¼ê³ ê¸°ìë¦¬ ì˜ˆì¸¡ ì„±ê³µ!'); flashCard('compBattle','goldFlash'); }
        else{
          if(playerRoll>compRoll) winner='player';
          else if(playerRoll<compRoll) winner='computer';
          else{ if(playerCard.name==='ì²œì¹­ìë¦¬') winner='player'; else if(compCard.name==='ì²œì¹­ìë¦¬') winner='computer'; else winner='draw'; }
        }

        // ì „ê°ˆìë¦¬
        if(playerCard.name==='ì „ê°ˆìë¦¬' && winner==='computer') computerNextBonus-=1;
        if(compCard.name==='ì „ê°ˆìë¦¬' && winner==='player') playerNextBonus-=1;

        // ì‚¬ììë¦¬
        if(playerCard.name==='ì‚¬ììë¦¬' && winner==='player') playerNextBonus+=1;
        if(compCard.name==='ì‚¬ììë¦¬' && winner==='computer') computerNextBonus+=1;

        // ê²Œìë¦¬
        if(compCard.name==='ê²Œìë¦¬' && winner==='player') winner='draw';
        if(playerCard.name==='ê²Œìë¦¬' && winner==='computer') winner='draw';

        // ìŠ¹íŒ¨ 2ì´ˆ ëŒ€ê¸° í›„ ì²˜ë¦¬
        setTimeout(()=>{
          if(winner==='player'){ playerScore++; logMsg('ë„ˆê°€ ìŠ¹ë¦¬!'); flashCard('playerBattle','goldFlash');}
          else if(winner==='computer'){ computerScore++; logMsg('ì»´í“¨í„° ìŠ¹ë¦¬!'); flashCard('compBattle','goldFlash');}
          else logMsg('ë¬´ìŠ¹ë¶€!');

          document.getElementById('playerScore').innerText=playerScore;
          document.getElementById('computerScore').innerText=computerScore;

          // ì¹´ë“œ êµì²´
          playerHand.splice(idx,1); playerHand.push(allCards[Math.floor(Math.random()*allCards.length)]);
          computerHand.splice(compIdx,1); computerHand.push(allCards[Math.floor(Math.random()*allCards.length)]);

          round++;
          updateHand();
          clearBattle();

          if(round>5){
            if(playerScore>computerScore) logMsg('ê²Œì„ ì¢…ë£Œ! ğŸ‰ ë„ˆ ìŠ¹ë¦¬!');
            else if(playerScore<computerScore) logMsg('ê²Œì„ ì¢…ë£Œ! ğŸ˜¢ ì»´í“¨í„° ìŠ¹ë¦¬!');
            else logMsg('ê²Œì„ ì¢…ë£Œ! ë¬´ìŠ¹ë¶€!');
          }
        },2000);

      });
    });
  },2000);
}

function logMsg(msg){
  const log=document.getElementById('log');
  log.innerHTML+=msg+'<br>';
  log.scrollTop=log.scrollHeight;
}

function flashCard(id,className){
  const el=document.getElementById(id);
  if(el){
    el.classList.add(className);
    setTimeout(()=>el.classList.remove(className),800);
  }
}

deal();
</script>
</body>
</html>
